function getQueryParam(name){const url=new URL(window.location.href);return url.searchParams.get(name);}
function getSlug(){const p=getQueryParam('c');if(p) return p.toLowerCase();const host=window.location.host;const parts=host.split('.');if(parts.length>=3){const sub=parts[0];if(sub && sub!=='www') return sub.toLowerCase();}return 'clarisa';}
async function loadProfile(){const slug=getSlug();const url=`clients/${slug}.json`;try{const res=await fetch(url,{cache:'no-cache'});if(!res.ok) throw new Error('Perfil no encontrado');const data=await res.json();render(data);}catch(e){document.body.innerHTML=`<main class="card"><h1>Perfil no encontrado</h1><p style="opacity:.7">No se pudo cargar <b>${url}</b>. Verific√° que exista el archivo JSON en <code>/clients/</code>.</p></main>`;}}
function waLink(phone,text){let p=phone.replace(/\D/g,'');let base=`https://wa.me/${p}`;if(text) base+=`?text=${encodeURIComponent(text)}`;return base;}
function makeTag(t){const el=document.createElement('span');el.className='tag';el.textContent=t;return el;}
function iconFor(name){const map={map:'üìç',cart:'üõí',file:'üìÑ',link:'üîó',menu:'üçΩÔ∏è',phone:'üìû',site:'üåê',video:'üé•',tiktok:'üéµ',calendar:'üìÖ',insta:'üì∏',pay:'üí≥'};return map[name]||'üîó';}
function render(d){document.title=d.title||'BioExpress';document.getElementById('avatar').src=d.avatar||'https://i.pravatar.cc/120';document.getElementById('title').textContent=d.title||'';document.getElementById('subtitle').textContent=d.subtitle||'';const tags=document.getElementById('tags');tags.innerHTML='';(d.tags||[]).forEach(t=>tags.appendChild(makeTag(t)));const wa=document.getElementById('cta-wa');wa.href=waLink(d.whatsapp,d.wa_text||'¬°Hola! Quiero info üôÇ');const ig=document.getElementById('cta-ig');if(d.instagram){ig.style.display='inline-flex';ig.href=d.instagram;}const res=document.getElementById('cta-reserve');if(d.reserve){res.style.display='inline-flex';res.href=d.reserve;}const pay=document.getElementById('cta-pay');if(d.pay){pay.style.display='inline-flex';pay.href=d.pay;}const list=document.getElementById('highlights');list.innerHTML='';(d.highlights||[]).forEach(h=>{const tpl=document.getElementById('item-row').content.cloneNode(true);tpl.querySelector('.icon').textContent=iconFor(h.icon||'menu');tpl.querySelector('.label').textContent=h.title;tpl.querySelector('.sublabel').textContent=h.subtitle||(h.price?h.price:'');const btn=tpl.querySelector('.btn');const href=h.url||waLink(d.whatsapp,h.wa_text||`Hola, quiero ${h.title}`);btn.href=href;btn.textContent=h.cta||'Elegir';list.appendChild(tpl);});const links=document.getElementById('links');links.innerHTML='';(d.links||[]).forEach(l=>{const tpl=document.getElementById('item-row').content.cloneNode(true);tpl.querySelector('.icon').textContent=iconFor(l.icon||'link');tpl.querySelector('.label').textContent=l.label;tpl.querySelector('.sublabel').textContent=l.sublabel||'';const btn=tpl.querySelector('.btn');btn.href=l.url;btn.textContent=l.cta||'Abrir';links.appendChild(tpl);});document.getElementById('notes').textContent=d.notes||'';if(d.theme && d.theme.accent){document.documentElement.style.setProperty('--accent',d.theme.accent);}}
loadProfile();
